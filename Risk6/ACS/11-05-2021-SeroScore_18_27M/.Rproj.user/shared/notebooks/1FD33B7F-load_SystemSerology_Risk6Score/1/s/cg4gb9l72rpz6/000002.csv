"0","library(pheatmap)"
"0",""
"0","annotation_row <- data.frame(group1 = Data_group, group = Data_group)"
"0","rownames(annotation_row) <- rownames(Data_combining)"
"0",""
"0","ordered_index <- order(annotation_row$group, annotation_row$group1)"
"0","annotation_row_ordered <- annotation_row[ordered_index, ]"
"0",""
"0","data.sero.ordered <- scale(Data_combining[ordered_index, ], center = TRUE, scale = TRUE)"
"0",""
"0","mat_breaks <- quantile_breaks(na.omit(unlist(data.sero.ordered)), n = 100)"
"0","png(file.path(output_dir, ""heatmap.scaled.png""), width=3560, height=1940, res = 300)"
"0","pheatmap("
"0","    mat = data.sero.ordered,"
"0","   border_color = NA,"
"0","    color = colorRampPalette(rev(brewer.pal(n = 8, name = ""RdYlBu"")))(length(mat_breaks) - 1),"
"0","    #color = inferno(length(mat_breaks) - 1),"
"0","    breaks = mat_breaks,"
"0","    show_rownames = FALSE,"
"0","    show_colnames = TRUE,"
"0","    cluster_rows = FALSE,"
"0","    cluster_cols = TRUE,"
"0","    annotation_row = annotation_row_ordered,"
"0","    annotation_colors = meta_colors,"
"0","    fontsize = 6,"
"0","    fontsize_col = 5,"
"0","    fontsize_row = 5,"
"0","    scale = ""none"","
"0","    main  = ""Serology Data with Quantile Color Scale"""
"0","  )"
