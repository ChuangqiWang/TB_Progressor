"0","library(pheatmap)"
"0","annotation_row <- data.frame(group = meta.data$group, ID = meta.data$ID, timetoTB = meta.data$timetoTB)"
"0","rownames(annotation_row) <- meta.data$Ragon_ID"
"0",""
"0","ordered_index <- order(annotation_row$group, annotation_row$ID, annotation_row$timetoTB)"
"0","annotation_row_ordered <- annotation_row[ordered_index, ]"
"0",""
"0",""
"0","SystemSerogy.ordered <- SystemSerogy[ordered_index, ]"
"0",""
"0","mat_breaks <- quantile_breaks(na.omit(unlist(SystemSerogy)), n = 100)"
"0","png(file.path(results.folder, ""SerologyData.png""), width=3560, height=3560, res = 300)"
"0","pheatmap("
"0","    mat = SystemSerogy.ordered,"
"0","    border_color = NA,"
"0","    color = colorRampPalette(rev(brewer.pal(n = 8, name = ""RdYlBu"")))(length(mat_breaks) - 1),"
"0","    #color = inferno(length(mat_breaks) - 1),"
"0","    breaks = mat_breaks,"
"0","    show_rownames = FALSE,"
"0","    show_colnames = TRUE,"
"0","    cluster_rows = FALSE,"
"0","    cluster_cols = TRUE,"
"0","    annotation_row = annotation_row_ordered,"
"0","    annotation_colors = meta_colors,"
"0","    fontsize = 6,"
"0","    fontsize_col = 5,"
"0","    fontsize_row = 5,"
"0","    scale = ""none"","
"0","    main  = ""Serology Data with Quantile Color Scale"""
"0",")"
