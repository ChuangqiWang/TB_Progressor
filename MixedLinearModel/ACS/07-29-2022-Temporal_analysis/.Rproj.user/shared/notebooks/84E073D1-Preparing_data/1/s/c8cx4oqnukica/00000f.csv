"0","meta.sero.data <- meta.progressors"
"0","sero.data.index <- c()"
"0","for(index in 1 : dim(meta.progressors)[1]){"
"0","  temp.meta <- meta.progressors[index, ]"
"0","  ID.index <- which(progressors$`Sample ID` == temp.meta$SubjectID)"
"0","  VisitType.index <- which(progressors$VisitType == temp.meta$VisitType)"
"0","  index <- intersect(ID.index, VisitType.index)"
"0","  #print(index)"
"0","  if(length(index) == 0){"
"0","    sero.data.index <- c(sero.data.index, NA)"
"0","  }else{"
"0","    sero.data.index <- c(sero.data.index, index)"
"0","  }"
"0","}"
"0",""
"0","meta.sero.data <- meta.sero.data[!is.na(sero.data.index), ]"
"0","sero.data.index <- sero.data.index[!is.na(sero.data.index)]"
"0","sero.data <- progressors[sero.data.index, c(3, 7, 9:dim(progressors)[2])]"
"0","#Remove the 'Ebola' and 'HA'"
"0","eliminating.antigen <- c('Ebola', 'HA', 'CMV', 'EBV')"
"0","Ebola.related <- grep('Ebola', colnames(sero.data), value=TRUE)"
"0","HA.related <- grep('HA', colnames(sero.data), value=TRUE)"
"0","CMV.related <- grep('CMV', colnames(sero.data), value=TRUE)"
"0","EBV.related <- grep('EBV', colnames(sero.data), value=TRUE)"
"0",""
"0","excluded.features <- c(Ebola.related, HA.related, CMV.related, EBV.related)"
"0","feature.index <- which(colnames(sero.data) %in% excluded.features)"
"0","sero.data <- sero.data[, -feature.index]"
"0",""
"0","meta.sero.data <- cbind(meta.sero.data, sero.data)"
"0","meta.sero.data$aliquot_plate <- factor(meta.sero.data$aliquot_plate)"
"0","saveRDS(meta.sero.data, 'meta.sero.data.RDS')"
