"0","library(lme4)"
"2","Warning:"
"2"," package ‘lme4’ was built under R version 4.1.3
"
"2","Loading required package: Matrix
"
"0","#Create a folder to save the results."
"0","saved.dic <- './LinearMixedModel.VisitDate'"
"0","if (!dir.exists(saved.dic)){"
"0","  dir.create((saved.dic))"
"0","}"
"0","#Build two models with or without clinical.label and then compare the significance using anova (likehood ratio test)"
"0","pvalue <- c()"
"0","coefficient <- data.frame()"
"0","t.value <- data.frame()"
"0","for(feat.index in 1:length(feature.name)){"
"0","  response <- feature.name[feat.index]"
"0","  print(response)"
"0","  temp.data.mlm <- meta.sero.data[, c(1:12, feat.index + 12)]"
"0","  colnames(temp.data.mlm)[13] <- 'response'"
"0","  #Basic model without considering Pat.clinical.label variable."
"0","  model.null <- lmer(response ~ 1 + Sex + AgeAtLastBirthDay + SchoolCode + VisitType  + (1|SubjectID), data = temp.data.mlm, REML = FALSE)"
"0","  saveRDS(summary(model.null), file.path(saved.dic, paste(response, 'null.model.RDS')))"
"0","  saveRDS(coef(model.null)$SubjectID, file.path(saved.dic, paste(response, 'null.mode.coeff.RDS')))"
"0","  "
"0","  print(""Full"")"
"0","  #Alternative model with Pat.clinical.label variable."
"0","  model.alternative <- lmer(response ~ 1 + Sex + AgeAtLastBirthDay + SchoolCode + VisitType + Group  + (1|SubjectID), data = temp.data.mlm, REML = FALSE)"
"0","  saveRDS(summary(model.alternative), file.path(saved.dic, paste(response, 'alternative.model.RDS')))"
"0","  saveRDS(coef(model.alternative)$SubjectID, file.path(saved.dic, paste(response, 'alternative.mode.coeff.RDS')))"
"0","  #"
"0","  #model.alternative Summary"
"0","  summary.model.alternative <- summary(model.alternative)"
"0","  coefficient <- rbind(coefficient, summary.model.alternative$coefficients[, 1])"
"0","  t.value <- rbind(t.value, summary.model.alternative$coefficients[, 3])"
"0","  "
"0","  "
"0","  #Likelihood ratio test"
"0","  LRT <- anova(model.alternative, model.null)"
"0","  saveRDS(LRT, file.path(saved.dic, paste(response, 'LRT.RDS')))"
"0","  pvalue <- c(pvalue, LRT$`Pr(>Chisq)`[2])"
"0","}"
"1","[1]"
"1"," ""totalIgG_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""totalIgG_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""totalIgG_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""totalIgG_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""totalIgG_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""totalIgG_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""totalIgG_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG1_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG1_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG1_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG1_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG1_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG1_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG1_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG2_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG2_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG2_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG2_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG2_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG2_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG2_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG3_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG3_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG3_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG3_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG3_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG3_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG3_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG4_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG4_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG4_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG4_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG4_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG4_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgG4_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA1_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA1_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA1_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA1_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA1_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA1_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA1_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA2_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA2_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA2_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA2_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA2_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA2_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgA2_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgM_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgM_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgM_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgM_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgM_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgM_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""IgM_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""ADCP_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""ADCP_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""ADCP_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""ADNP_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"2","boundary (singular) fit: see help('isSingular')
"
"1","[1]"
"1"," ""ADNP_ESAT6"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"2","boundary (singular) fit: see help('isSingular')
"
"1","[1]"
"1"," ""ADNP_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"2","boundary (singular) fit: see help('isSingular')
"
"1","[1]"
"1"," ""FcgR2A_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2A_ESAT6_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2A_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2A_TbAd"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2A_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2A_Ag85 AB"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2B_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2B_ESAT6_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2B_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2B_TbAd"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2B_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR2B_Ag85 AB"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3A_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3A_ESAT6_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3A_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3A_TbAd"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3A_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3A_Ag85 AB"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3B_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3B_ESAT6_CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3B_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3B_TbAd"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3B_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""FcgR3B_Ag85 AB"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""SNA_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""SNA_ESAT6 CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""SNA_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""SNA_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""SNA_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""SNA_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""RCA_PPD"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""RCA_ESAT6 CFP10"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""RCA_Hspx"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""RCA_Ag85"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""RCA_Tbad"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"1","[1]"
"1"," ""RCA_LAM"""
"1","
"
"1","[1]"
"1"," ""Full"""
"1","
"
"0","saveRDS(pvalue, 'pvalue.RDS')"
"0","saveRDS(coefficient, 'coefficient.RDS')"
"0",""
"0","colnames(coefficient) <- rownames(summary.model.alternative$coefficients)"
"0","rownames(coefficient) <- feature.name"
"0","coefficient.pLRT <- coefficient"
"0","coefficient.pLRT$pvalue <- pvalue"
"0","saveRDS(coefficient.pLRT, 'coefficient.pLRT.value.RDS')"
"0",""
"0","colnames(t.value) <- rownames(summary.model.alternative$coefficients)"
"0","rownames(t.value) <- feature.name"
"0","t.value.pLRT <- t.value"
"0","t.value.pLRT$pvalue <- pvalue"
"0","saveRDS(t.value.pLRT, 't.value.pLRT.value.RDS')"
