"0","library(ggplot2)"
"0","library(ggrepel)"
"0",""
"0",""
"0","t.value.size.pLRT <- readRDS('t.value.pLRT.value.RDS')"
"0","#Adjust the pvalue based on BH method."
"0","pvalue.adjust <- p.adjust(t.value.size.pLRT$pvalue, method = 'BH')"
"0","t.value.size.pLRT$pvalue.adjust <- pvalue.adjust"
"0","saveRDS(t.value.size.pLRT, 't.value.pLRT.value.RDS')"
"0","# Add text to the plot"
"0","feature.labs <- rownames(t.value.size.pLRT)"
"0",""
"0","# Add text to the plot"
"0",".labs <- rownames(t.value.size.pLRT)"
"0","t.value.size.pLRT$feature_class <- rep(""FcR"", length = nrow(t.value.size.pLRT))"
"0","t.value.size.pLRT$feature_class[which(grepl(""IgG|IgA|IgM"", .labs))] <- ""titer"""
"0","t.value.size.pLRT$feature_class[which(grepl(""RCA|SNA"", .labs))] <- ""Lectin"""
"0","t.value.size.pLRT$feature_class[which(grepl(""ADNP|ADCP"", .labs))] <- ""Function"""
"0","t.value.size.pLRT$feature_class <- factor(t.value.size.pLRT$feature_class)"
"0",""
"0","t.value.size.pLRT$Antigen <- rep(""PPD"", length = nrow(t.value.size.pLRT))"
"0","t.value.size.pLRT$Antigen[which(grepl(""_ESAT6"", .labs))] <- ""ESAT6"""
"0","t.value.size.pLRT$Antigen[which(grepl(""_Hspx"", .labs))] <- ""Hspx"""
"0","t.value.size.pLRT$Antigen[which(grepl(""_CFP10"", .labs))] <- ""CFP10"""
"0","t.value.size.pLRT$Antigen[which(grepl(""_Ag85"", .labs))] <- ""Ag85"""
"0","t.value.size.pLRT$Antigen[which(grepl(""_CMV_pentamer"", .labs))] <- ""CMV_pentamer"""
"0","t.value.size.pLRT$Antigen[which(grepl(""_CMV_gB"", .labs))] <- ""CMV_gB"""
"0","t.value.size.pLRT$Antigen[which(grepl(""_EBV"", .labs))] <- ""EBV"""
"0","t.value.size.pLRT$Antigen[which(grepl(""_Tbad"", .labs))] <- ""Tbad"""
"0","t.value.size.pLRT$Antigen[which(grepl(""_LAM"", .labs))] <- ""LAM"""
"0",""
"0","# Add text to the plot"
"0","feature.labs <- rownames(t.value.size.pLRT)"
"0","temp.index <- which(pvalue.adjust >= 0.05)"
"0","feature.labs[temp.index] <- """""
"0","# effect size between label2 vs 1"
"0","ggplot(t.value.size.pLRT, aes(Groupprogressor, -log10(pvalue.adjust))) +"
"0","  labs(x = 'T value: progressor vs nonprogressor', y = '-log10(BH.adjused.pvalue.LRT)') +"
"0","  geom_point(aes(color = Antigen), size = 2, position = position_jitter(width = 0.01, height = 0.01)) + "
"0","  geom_hline(yintercept=-log10(0.05), linetype=""dashed"", color = ""gray"", size=1) +"
"0","  #geom_vline(xintercept=0.8, linetype=""dashed"", color = ""red"", size=1) +"
"0","  geom_text_repel(aes(label = feature.labs), size = 3.5) +"
"0","  #scale_color_manual(values = c(""#00AFBB"", ""#E7B800"", ""#FC4E07""))"
"0","  theme_classic()"
