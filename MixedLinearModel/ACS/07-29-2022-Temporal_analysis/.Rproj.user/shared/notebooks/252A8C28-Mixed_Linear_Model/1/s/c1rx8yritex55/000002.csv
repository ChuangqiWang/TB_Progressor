"0","```r
library(lme4)
```"
"1","Loading required package: Matrix
"
"0","```r
#Create a folder to save the results.
saved.dic <- './LinearMixedModel.VisitDate'
if (!dir.exists(saved.dic)){
  dir.create((saved.dic))
}
#Build two models with or without clinical.label and then compare the significance using anova (likehood ratio test)
pvalue <- c()
coefficient <- data.frame()
t.value <- data.frame()
for(feat.index in 1:122){
  response <- feature.name[feat.index]
  print(response)
  temp.data.mlm <- meta.sero.data[, c(1:12, feat.index + 12)]
  colnames(temp.data.mlm)[13] <- 'response'
  #Basic model without considering Pat.clinical.label variable.
  model.null <- lmer(response ~ 1 + Sex + AgeAtLastBirthDay + SchoolCode + VisitType + PreviousDiagnosisOfTB + aliquot_plate  +  (1|SubjectID), data = temp.data.mlm, REML = FALSE)
  saveRDS(summary(model.null), file.path(saved.dic, paste(response, 'null.model.RDS')))
  saveRDS(coef(model.null)$SubjectID, file.path(saved.dic, paste(response, 'null.mode.coeff.RDS')))
  
  print(\"Full\")
  #Alternative model with Pat.clinical.label variable.
  model.alternative <- lmer(response ~ 1 + Sex + AgeAtLastBirthDay + SchoolCode + VisitType + PreviousDiagnosisOfTB + aliquot_plate + Group  + (1|SubjectID), data = temp.data.mlm, REML = FALSE)
  saveRDS(summary(model.alternative), file.path(saved.dic, paste(response, 'alternative.model.RDS')))
  saveRDS(coef(model.alternative)$SubjectID, file.path(saved.dic, paste(response, 'alternative.mode.coeff.RDS')))
  #
  #model.alternative Summary
  summary.model.alternative <- summary(model.alternative)
  coefficient <- rbind(coefficient, summary.model.alternative$coefficients[, 1])
  t.value <- rbind(t.value, summary.model.alternative$coefficients[, 3])
  
  
  #Likelihood ratio test
  LRT <- anova(model.alternative, model.null)
  saveRDS(LRT, file.path(saved.dic, paste(response, 'LRT.RDS')))
  pvalue <- c(pvalue, LRT$`Pr(>Chisq)`[2])
}
```"
"1","[1] \"totalIgG_PPD\"
[1] \"Full\"
[1] \"totalIgG_ESAT6\"
[1] \"Full\"
[1] \"totalIgG_Hspx\"
[1] \"Full\"
[1] \"totalIgG_CFP10\"
[1] \"Full\"
[1] \"totalIgG_Ag85\"
[1] \"Full\"
[1] \"totalIgG_CMV_pentamer\"
[1] \"Full\"
[1] \"totalIgG_CMV_gB\"
[1] \"Full\"
[1] \"totalIgG_EBV\"
[1] \"Full\"
[1] \"totalIgG_Tbad\"
[1] \"Full\"
[1] \"totalIgG_LAM\"
[1] \"Full\"
[1] \"IgG1_PPD\"
[1] \"Full\"
[1] \"IgG1_ESAT6\"
[1] \"Full\"
[1] \"IgG1_Hspx\"
[1] \"Full\"
[1] \"IgG1_CFP10\"
[1] \"Full\"
[1] \"IgG1_Ag85\"
[1] \"Full\"
[1] \"IgG1_CMV_pentamer\"
[1] \"Full\"
[1] \"IgG1_CMV_gB\"
[1] \"Full\"
[1] \"IgG1_EBV\"
[1] \"Full\"
[1] \"IgG1_Tbad\"
[1] \"Full\"
[1] \"IgG1_LAM\"
[1] \"Full\"
[1] \"IgG2_PPD\"
[1] \"Full\"
[1] \"IgG2_ESAT6\"
[1] \"Full\"
[1] \"IgG2_Hspx\"
[1] \"Full\"
[1] \"IgG2_CFP10\"
[1] \"Full\"
[1] \"IgG2_Ag85\"
[1] \"Full\"
[1] \"IgG2_CMV_pentamer\"
[1] \"Full\"
[1] \"IgG2_CMV_gB\"
[1] \"Full\"
[1] \"IgG2_EBV\"
[1] \"Full\"
[1] \"IgG2_Tbad\"
[1] \"Full\"
[1] \"IgG2_LAM\"
[1] \"Full\"
[1] \"IgG3_PPD\"
[1] \"Full\"
[1] \"IgG3_ESAT6\"
[1] \"Full\"
[1] \"IgG3_Hspx\"
[1] \"Full\"
[1] \"IgG3_CFP10\"
[1] \"Full\"
[1] \"IgG3_Ag85\"
[1] \"Full\"
[1] \"IgG3_CMV_pentamer\"
[1] \"Full\"
[1] \"IgG3_CMV_gB\"
[1] \"Full\"
[1] \"IgG3_EBV\"
[1] \"Full\"
[1] \"IgG3_Tbad\"
[1] \"Full\"
[1] \"IgG3_LAM\"
[1] \"Full\"
[1] \"IgG4_PPD\"
[1] \"Full\"
[1] \"IgG4_ESAT6\"
[1] \"Full\"
[1] \"IgG4_Hspx\"
[1] \"Full\"
[1] \"IgG4_CFP10\"
[1] \"Full\"
[1] \"IgG4_Ag85\"
[1] \"Full\"
[1] \"IgG4_CMV_pentamer\"
[1] \"Full\"
[1] \"IgG4_CMV_gB\"
[1] \"Full\"
[1] \"IgG4_EBV\"
[1] \"Full\"
[1] \"IgG4_Tbad\"
[1] \"Full\"
[1] \"IgG4_LAM\"
[1] \"Full\"
[1] \"IgA1_PPD\"
[1] \"Full\"
[1] \"IgA1_ESAT6\"
[1] \"Full\"
[1] \"IgA1_Hspx\"
[1] \"Full\"
[1] \"IgA1_CFP10\"
[1] \"Full\"
[1] \"IgA1_Ag85\"
[1] \"Full\"
[1] \"IgA1_CMV_pentamer\"
[1] \"Full\"
[1] \"IgA1_CMV_gB\"
[1] \"Full\"
[1] \"IgA1_EBV\"
[1] \"Full\"
[1] \"IgA1_Tbad\"
[1] \"Full\"
[1] \"IgA1_LAM\"
[1] \"Full\"
[1] \"IgA2_PPD\"
[1] \"Full\"
[1] \"IgA2_ESAT6\"
[1] \"Full\"
[1] \"IgA2_Hspx\"
[1] \"Full\"
[1] \"IgA2_CFP10\"
[1] \"Full\"
[1] \"IgA2_Ag85\"
"
"1","boundary (singular) fit: see ?isSingular
"
"1","[1] \"Full\"
"
"1","boundary (singular) fit: see ?isSingular
"
"1","[1] \"IgA2_CMV_pentamer\"
[1] \"Full\"
[1] \"IgA2_CMV_gB\"
[1] \"Full\"
[1] \"IgA2_EBV\"
[1] \"Full\"
[1] \"IgA2_Tbad\"
[1] \"Full\"
[1] \"IgA2_LAM\"
[1] \"Full\"
[1] \"IgM_PPD\"
[1] \"Full\"
[1] \"IgM_ESAT6\"
[1] \"Full\"
[1] \"IgM_Hspx\"
[1] \"Full\"
[1] \"IgM_CFP10\"
[1] \"Full\"
[1] \"IgM_Ag85\"
[1] \"Full\"
[1] \"IgM_CMV_pentamer\"
[1] \"Full\"
[1] \"IgM_CMV_gB\"
[1] \"Full\"
[1] \"IgM_EBV\"
[1] \"Full\"
[1] \"IgM_Tbad\"
[1] \"Full\"
[1] \"IgM_LAM\"
[1] \"Full\"
[1] \"ADCP_PPD\"
[1] \"Full\"
[1] \"ADCP_ESAT6\"
[1] \"Full\"
[1] \"ADCP_LAM\"
[1] \"Full\"
[1] \"ADNP_PPD\"
[1] \"Full\"
"
"1","boundary (singular) fit: see ?isSingular
"
"1","[1] \"ADNP_ESAT6\"
[1] \"Full\"
[1] \"ADNP_LAM\"
"
"1","boundary (singular) fit: see ?isSingular
"
"1","[1] \"Full\"
"
"1","boundary (singular) fit: see ?isSingular
"
"1","[1] \"FcgR2A_LAM\"
[1] \"Full\"
[1] \"FcgR2A_ESAT6_CFP10\"
[1] \"Full\"
[1] \"FcgR2A_PPD\"
[1] \"Full\"
[1] \"FcgR2A_TbAd\"
[1] \"Full\"
[1] \"FcgR2A_Hspx\"
[1] \"Full\"
[1] \"FcgR2A_Ag85 AB\"
[1] \"Full\"
[1] \"FcgR2B_LAM\"
[1] \"Full\"
[1] \"FcgR2B_ESAT6_CFP10\"
[1] \"Full\"
[1] \"FcgR2B_PPD\"
[1] \"Full\"
[1] \"FcgR2B_TbAd\"
[1] \"Full\"
[1] \"FcgR2B_Hspx\"
[1] \"Full\"
[1] \"FcgR2B_Ag85 AB\"
[1] \"Full\"
[1] \"FcgR3A_LAM\"
[1] \"Full\"
[1] \"FcgR3A_ESAT6_CFP10\"
[1] \"Full\"
[1] \"FcgR3A_PPD\"
[1] \"Full\"
[1] \"FcgR3A_TbAd\"
[1] \"Full\"
[1] \"FcgR3A_Hspx\"
[1] \"Full\"
[1] \"FcgR3A_Ag85 AB\"
[1] \"Full\"
[1] \"FcgR3B_LAM\"
[1] \"Full\"
[1] \"FcgR3B_ESAT6_CFP10\"
[1] \"Full\"
[1] \"FcgR3B_PPD\"
[1] \"Full\"
[1] \"FcgR3B_TbAd\"
[1] \"Full\"
[1] \"FcgR3B_Hspx\"
[1] \"Full\"
[1] \"FcgR3B_Ag85 AB\"
[1] \"Full\"
[1] \"SNA_PPD\"
[1] \"Full\"
[1] \"SNA_ESAT6_CFP10\"
[1] \"Full\"
[1] \"SNA_TbAd\"
[1] \"Full\"
[1] \"SNA_Ag85\"
[1] \"Full\"
[1] \"SNA_HspX\"
[1] \"Full\"
[1] \"SNA_LAM\"
[1] \"Full\"
[1] \"RCA_PPD\"
[1] \"Full\"
[1] \"RCA_ESAT6_CFP10\"
[1] \"Full\"
[1] \"RCA_TbAd\"
[1] \"Full\"
[1] \"RCA_Ag85\"
[1] \"Full\"
[1] \"RCA_HspX\"
[1] \"Full\"
[1] \"RCA_LAM\"
[1] \"Full\"
"
"0","```r
saveRDS(pvalue, 'pvalue.RDS')
saveRDS(coefficient, 'coefficient.RDS')

colnames(coefficient) <- rownames(summary.model.alternative$coefficients)
rownames(coefficient) <- feature.name
coefficient.pLRT <- coefficient
coefficient.pLRT$pvalue <- pvalue
saveRDS(coefficient.pLRT, 'coefficient.pLRT.value.RDS')

colnames(t.value) <- rownames(summary.model.alternative$coefficients)
rownames(t.value) <- feature.name
t.value.pLRT <- t.value
t.value.pLRT$pvalue <- pvalue
saveRDS(t.value.pLRT, 't.value.pLRT.value.RDS')
```"
