"0","library(tidyverse)"
"0","library(igraph)"
"0","library(ggraph)"
"0","library(ggrepel)"
"0","library(RColorBrewer)"
"0","library(reshape2)"
"0","library(spdep)"
"0","melt.coef.selected <- melt(corrMat.coef.selected)"
"0","melt.adjpvalue.selected <- melt(corrMat.adjpvalue)"
"0","adjpvalue.selected.index <- which(melt.adjpvalue.selected$value < 0.05)"
"0",""
"0","melt.coef.selected.sign <- melt.coef.selected[adjpvalue.selected.index, ]"
"0","melt.adjpvalue.selected.sign <- melt.adjpvalue.selected[adjpvalue.selected.index, ]"
"0","colnames(melt.coef.selected.sign) <- c(""x"", ""y"", ""corr.coef"")"
"0","#Plot"
"0","graphCors <- melt.coef.selected.sign %>% "
"0","  filter(abs(corr.coef) > default_threshold  & (is.element(x, selected_features) | is.element(y, selected_features))) %>% "
"0","  graph_from_data_frame(directed = FALSE)"
"0",""
"0","layout <- create_layout(graphCors, layout = 'igraph', algorithm = 'nicely')"
"0","#manual_layout <- create_layout(graph = igraph_data,"
"0","#              layout = ""manual"", node.positions = data2)"
"0","#layout_coordinates <- as.matrix(layout[, c(1,2)])"
"0","#layout_v2 <- Rotation(layout_coordinates, 10*pi/180)"
"0","#layout$x <- layout_v2[, 1]"
"0","#layout$y <- layout_v2[, 2]"
"0","#color the node."
"0","temp.index <- which(layout$name %in% selected_features)"
"0","group <- rep(""NO"", dim(layout)[1])"
"0","group[temp.index] <- ""YES"""
"0","layout$group <- factor(group)"
"0",""
"0","color <- rep(""NA"", dim(layout)[1])"
"0","for(index in 1:dim(layout)[1]){"
"0","  temp.index <- which(layout[index, ]$name == selected_features)"
"0","  #print(temp.index)"
"0","  if(length(temp.index) == 1){"
"0","    color[index] <- Enriched_group[temp.index]"
"0","  }"
"0","}"
"0","layout$color <- factor(color)"
"0",""
